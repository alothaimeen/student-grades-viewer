@echo off
chcp 65001 > nul
REM =====================================================
REM ๐ ุณูุฑูุจุช ุงูุชุญุฏูุซ ุงูุดุงูู - Batch
REM =====================================================
REM ูููู ุจุชุญููู ุฌููุน ุงููููุงุช ูุฑูุนูุง ุฅูู GitHub ุฏูุนุฉ ูุงุญุฏุฉ

echo =====================================================================
echo ๐ ุงูุชุญุฏูุซ ุงูุดุงูู - ุชุญุฏูุซ ุฌููุน ุงูุจูุงูุงุช
echo =====================================================================
echo.

set successCount=0
set failCount=0

REM =====================================================
REM ุงูุฎุทูุฉ 1: ุชุญููู ุงููุชุฑุฉ ุงูุฃููู
REM =====================================================
echo ๐ [1/3] ุชุญููู ุจูุงูุงุช ุงููุชุฑุฉ ุงูุฃููู...
echo.

python convert_excel_to_json.py

if errorlevel 1 (
    echo โ ูุดู ุชุญููู ุงููุชุฑุฉ ุงูุฃููู
    set /a failCount+=1
) else (
    echo โ ูุฌุญ ุชุญููู ุงููุชุฑุฉ ุงูุฃููู
    set /a successCount+=1
)

echo.
echo =====================================================================
echo.

REM =====================================================
REM ุงูุฎุทูุฉ 2: ุชุญููู ุงููุชุฑุฉ ุงูุซุงููุฉ
REM =====================================================
echo ๐ [2/3] ุชุญููู ุจูุงูุงุช ุงููุชุฑุฉ ุงูุซุงููุฉ...
echo.

python convert_excel_to_json_period2.py

if errorlevel 1 (
    echo โ ูุดู ุชุญููู ุงููุชุฑุฉ ุงูุซุงููุฉ
    set /a failCount+=1
) else (
    echo โ ูุฌุญ ุชุญููู ุงููุชุฑุฉ ุงูุซุงููุฉ
    set /a successCount+=1
)

echo.
echo =====================================================================
echo.

REM =====================================================
REM ุงูุฎุทูุฉ 3: ุชุญููู ุงูููุงุญุธุงุช
REM =====================================================
echo ๐ [3/3] ุชุญููู ุงูููุงุญุธุงุช ุงูุณููููุฉ...
echo.

python convert_notes_to_json.py

if errorlevel 1 (
    echo โ ูุดู ุชุญููู ุงูููุงุญุธุงุช
    set /a failCount+=1
) else (
    echo โ ูุฌุญ ุชุญููู ุงูููุงุญุธุงุช
    set /a successCount+=1
)

echo.
echo =====================================================================
echo.

REM =====================================================
REM ุนุฑุถ ุงููุชุงุฆุฌ
REM =====================================================
echo ๐ ุงููุชุงุฆุฌ:
echo    โ ูุฌุญ: %successCount%
echo    โ ูุดู: %failCount%
echo.

if %failCount% gtr 0 (
    echo โ๏ธ  ูุดู ุชุญููู %failCount% ูู ุงููููุงุช!
    echo ๐ก ุชุญูู ูู:
    echo    - ูุฌูุฏ ูููุงุช Excel ูู ุงููุฌูุฏ
    echo    - ุชุซุจูุช ุงูููุชุจุงุช: pip install -r requirements.txt
    echo.
    pause
    exit /b 1
)

REM =====================================================
REM ุงูุฎุทูุฉ 4: ุฑูุน ุงูุชุญุฏูุซุงุช ุฅูู GitHub
REM =====================================================
echo ๐ค [4/4] ุฑูุน ุงูุชุญุฏูุซุงุช ุฅูู GitHub...
echo.

REM ุฅุถุงูุฉ ุฌููุน ุงููููุงุช ุงููุญุฏุซุฉ
git add period1.json period2.json notes.json

REM ุงูุชุญูู ูู ูุฌูุฏ ุชุบููุฑุงุช
git diff-index --quiet HEAD --
if %errorlevel% equ 0 (
    echo โน๏ธ  ูุง ุชูุฌุฏ ุชุบููุฑุงุช ุฌุฏูุฏุฉ ุนูู ุงููููุงุช
    echo.
    pause
    exit /b 0
)

REM ุนุฑุถ ุงููููุงุช ุงููุนุฏูุฉ
echo ๐ ุงููููุงุช ุงููุนุฏูุฉ:
git status --short
echo.

REM ุฅูุดุงุก commit ูุน ุงูุชุงุฑูุฎ ูุงูููุช
for /f "tokens=2 delims==" %%I in ('wmic os get localdatetime /value') do set datetime=%%I
set date=%datetime:~0,4%-%datetime:~4,2%-%datetime:~6,2%
set time=%datetime:~8,2%:%datetime:~10,2%
git commit -m "๐ ุชุญุฏูุซ ุดุงูู ููุจูุงูุงุช - %date% %time%"

REM ุฑูุน ุงูุชุญุฏูุซุงุช
echo โฌ๏ธ  ุฌุงุฑู ุฑูุน ุงูุชุญุฏูุซุงุช...
git push origin main

if errorlevel 1 (
    echo.
    echo โ ุฎุทุฃ: ูุดู ุฑูุน ุงูุชุญุฏูุซุงุช ุฅูู GitHub!
    echo ๐ก ุชุฃูุฏ ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช ูุตูุงุญูุงุช GitHub
) else (
    echo.
    echo =====================================================================
    echo โ ุชู ุชุญุฏูุซ ุฌููุน ุงูุจูุงูุงุช ุจูุฌุงุญ!
    echo =====================================================================
    echo.
    echo ๐ ุชู ุชุญุฏูุซ:
    echo    โข ุงููุชุฑุฉ ุงูุฃููู ^(period1.json^)
    echo    โข ุงููุชุฑุฉ ุงูุซุงููุฉ ^(period2.json^)
    echo    โข ุงูููุงุญุธุงุช ุงูุณููููุฉ ^(notes.json^)
    echo.
    echo ๐ ุงููููุน ุณูุชุญุฏุซ ุฎูุงู ุฏูููุชูู!
    echo ๐ https://alothaimeen.github.io/student-grades-viewer/
)

echo.
pause
