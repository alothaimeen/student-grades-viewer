@echo off
chcp 65001 > nul
REM =====================================================
REM ๐ ุณูุฑูุจุช ุชุญุฏูุซ ุงูููุงุญุธุงุช ุงูุณููููุฉ - Batch
REM =====================================================
REM ูููู ุจุชุญููู ููู Excel ุงูููุงุญุธุงุช ุฅูู JSON ูุฑูุนู ุฅูู GitHub

echo =====================================================================
echo ๐ ุชุญุฏูุซ ุงูููุงุญุธุงุช ุงูุณููููุฉ - ุงููุธุงู ุงูุชููุงุฆู
echo =====================================================================
echo.

REM ุงูุฎุทูุฉ 1: ุชุญููู Excel ุฅูู JSON
echo ๐ ุงูุฎุทูุฉ 1: ุชุญููู ููู ุงูููุงุญุธุงุช...
echo.

python convert_notes_to_json.py

if errorlevel 1 (
    echo.
    echo โ ุฎุทุฃ: ูุดู ุชุญููู ุงูููู!
    echo ๐ก ุชุฃูุฏ ูู:
    echo    - ูุฌูุฏ ููู 'ุงูููุงุญุธุงุช.xlsx' ูู ุงููุฌูุฏ
    echo    - ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ: pip install -r requirements.txt
    echo.
    pause
    exit /b 1
)

echo.
echo =====================================================================

REM ุงูุฎุทูุฉ 2: ุฑูุน ุงูุชุญุฏูุซุงุช ุฅูู GitHub
echo ๐ค ุงูุฎุทูุฉ 2: ุฑูุน ุงูุชุญุฏูุซุงุช ุฅูู GitHub...
echo.

REM ุฅุถุงูุฉ ุงูููู ุงูุฌุฏูุฏ
git add notes.json

REM ุงูุชุญูู ูู ูุฌูุฏ ุชุบููุฑุงุช
git diff-index --quiet HEAD --
if %errorlevel% equ 0 (
    echo โน๏ธ  ูุง ุชูุฌุฏ ุชุบููุฑุงุช ุฌุฏูุฏุฉ ุนูู ููู ุงูููุงุญุธุงุช
    echo.
    pause
    exit /b 0
)

REM ุฅูุดุงุก commit ูุน ุงูุชุงุฑูุฎ ูุงูููุช
for /f "tokens=2 delims==" %%I in ('wmic os get localdatetime /value') do set datetime=%%I
set date=%datetime:~0,4%-%datetime:~4,2%-%datetime:~6,2%
set time=%datetime:~8,2%:%datetime:~10,2%
git commit -m "ุชุญุฏูุซ ุงูููุงุญุธุงุช ุงูุณููููุฉ - %date% %time%"

REM ุฑูุน ุงูุชุญุฏูุซุงุช
echo โฌ๏ธ  ุฌุงุฑู ุฑูุน ุงูุชุญุฏูุซุงุช...
git push origin main

if errorlevel 1 (
    echo.
    echo โ ุฎุทุฃ: ูุดู ุฑูุน ุงูุชุญุฏูุซุงุช ุฅูู GitHub!
    echo ๐ก ุชุฃูุฏ ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช ูุตูุงุญูุงุช GitHub
) else (
    echo.
    echo =====================================================================
    echo โ ุชู ุชุญุฏูุซ ุงูููุงุญุธุงุช ุจูุฌุงุญ!
    echo =====================================================================
    echo.
    echo ๐ ุงููููุน ุณูุชุญุฏุซ ุฎูุงู ุฏูููุชูู!
    echo ๐ https://alothaimeen.github.io/student-grades-viewer/
)

echo.
pause
